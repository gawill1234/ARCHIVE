#!/bin/bash

VCOLLECTION=""
checkflag=0

while getopts "C:e" flag; do
  case "$flag" in
     C) VCOLLECTION=$OPTARG;;
     e) checkflag=1;;
     *) echo "Usage: which_index -C <collection>"
        exit 1;;
  esac
done

if [ "$VCOLLECTION" == "" ]; then
   echo "Collection name must be specified"
   echo "Use the -C <collection> option"
   exit 1
fi

VINSTALL=$VIVISIMO_INSTALL_DIR
if [ "$VINSTALL" == "" ]; then
   VINSTALL="/usr/local/vivisimo-"
fi


mydir="data/collections/$VCOLLECTION"

if [ "$VERSION_FORCE" != "" ]; then
   cd $VINSTALL$VERSION_FORCE
else
   cd $VINSTALL
fi

if [ -f "$mydir/index0" ]; then
   thedir="$mydir/crawl0"
   theindex="$mydir/index0"
else
   if [ -f "$mydir/index1" ]; then
      thedir="$mydir/crawl1"
      theindex="$mydir/index1"
   else
      thedir=""
      theindex=""
   fi
fi

if [ "$theindex" != "" ]; then
   if [ $checkflag -eq 0 ]; then
      echo "$theindex, $thedir"
   fi
   exit 0
else
   exit 1
fi
